<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.33">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="apple-touch-icon" sizes="180x180" href="/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/pwa/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/pwa/favicon-16x16.png"><link rel="manifest" href="/pwa/site.webmanifest"><link rel="mask-icon" href="/pwa/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><title>模块化 | TommyHu</title><meta name="description" content="tommyhu.me">
    <link rel="modulepreload" href="/assets/app.f0c6e876.js"><link rel="modulepreload" href="/assets/模块化.html.d2802742.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/模块化.html.cfeb21cf.js">
    <link rel="stylesheet" href="/assets/style.7a8838ba.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/logo.jpg" alt="TommyHu"><span class="site-name can-hide">TommyHu</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="技术"><span class="title">技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="技术"><span class="title">技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>nodejs</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/blog/node/" class="" aria-label="node"><!--[--><!--]--> node <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>图形图像</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/blog/gojs/" class="" aria-label="gojs"><!--[--><!--]--> gojs <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>HTTP</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/blog/http/HTTP1.1.html" class="" aria-label="HTTP1.1"><!--[--><!--]--> HTTP1.1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/blog/http/crlf.html" class="" aria-label="CRLF"><!--[--><!--]--> CRLF <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="思考"><span class="title">思考</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="思考"><span class="title">思考</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>JavaScript高级语法</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%951.html" class="" aria-label="JavaScript高级语法1"><!--[--><!--]--> JavaScript高级语法1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%952.html" class="" aria-label="JavaScript高级语法2"><!--[--><!--]--> JavaScript高级语法2 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%953.html" class="" aria-label="JavaScript高级语法3"><!--[--><!--]--> JavaScript高级语法3 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%954.html" class="" aria-label="JavaScript高级语法4"><!--[--><!--]--> JavaScript高级语法4 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/Proxy%E5%92%8CReflect.html" class="" aria-label="Proxy和Reflect"><!--[--><!--]--> Proxy和Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/Promise.html" class="" aria-label="Promise"><!--[--><!--]--> Promise <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/Iterator%E5%92%8CGenerator.html" class="" aria-label="Iterator和Generator"><!--[--><!--]--> Iterator和Generator <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/async,await,%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF.html" class="" aria-label="async，await，事件循环"><!--[--><!--]--> async，await，事件循环 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86.html" class="" aria-label="错误处理"><!--[--><!--]--> 错误处理 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html" class="router-link-active router-link-exact-active router-link-active" aria-label="模块化"><!--[--><!--]--> 模块化 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JSON%E7%BB%86%E6%9E%90,%E6%B5%8F%E8%A7%88%E5%99%A8%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.html" class="" aria-label="JSON细析, 浏览器数据存储"><!--[--><!--]--> JSON细析, 浏览器数据存储 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/BOM,DOM%E7%AE%80%E6%9E%90.html" class="" aria-label="BOM,DOM简析"><!--[--><!--]--> BOM,DOM简析 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>设计模式</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html" class="" aria-label="工厂模式"><!--[--><!--]--> 工厂模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F.html" class="" aria-label="工厂方法模式"><!--[--><!--]--> 工厂方法模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html" class="" aria-label="抽象工厂模式"><!--[--><!--]--> 抽象工厂模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html" class="" aria-label="单例模式"><!--[--><!--]--> 单例模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F.html" class="" aria-label="适配器模式"><!--[--><!--]--> 适配器模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F(%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E8%80%85%E6%A8%A1%E5%BC%8F%E6%88%96%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6)/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.html" class="" aria-label="观察者模式"><!--[--><!--]--> 观察者模式 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>软件设计</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/SOLID.html" class="" aria-label="SOLD"><!--[--><!--]--> SOLD <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>算法</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/%E7%AE%97%E6%B3%95/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE.html" class="" aria-label="二分查找"><!--[--><!--]--> 二分查找 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小册"><span class="title">小册</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小册"><span class="title">小册</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/book/typescript%E9%80%9A%E8%A7%88.html" class="" aria-label="typescript通览"><!--[--><!--]--> typescript通览 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/blog/codes.md" class="" aria-label="碎片"><!--[--><!--]--> 碎片 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/chrome.html" class="" aria-label="谷歌插件"><!--[--><!--]--> 谷歌插件 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/npm.html" class="" aria-label="NPM PACKAGES"><!--[--><!--]--> NPM PACKAGES <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/bar/contact-author" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="技术"><span class="title">技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="技术"><span class="title">技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>nodejs</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/blog/node/" class="" aria-label="node"><!--[--><!--]--> node <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>图形图像</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/blog/gojs/" class="" aria-label="gojs"><!--[--><!--]--> gojs <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>HTTP</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/blog/http/HTTP1.1.html" class="" aria-label="HTTP1.1"><!--[--><!--]--> HTTP1.1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/blog/http/crlf.html" class="" aria-label="CRLF"><!--[--><!--]--> CRLF <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="思考"><span class="title">思考</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="思考"><span class="title">思考</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>JavaScript高级语法</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%951.html" class="" aria-label="JavaScript高级语法1"><!--[--><!--]--> JavaScript高级语法1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%952.html" class="" aria-label="JavaScript高级语法2"><!--[--><!--]--> JavaScript高级语法2 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%953.html" class="" aria-label="JavaScript高级语法3"><!--[--><!--]--> JavaScript高级语法3 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%954.html" class="" aria-label="JavaScript高级语法4"><!--[--><!--]--> JavaScript高级语法4 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/Proxy%E5%92%8CReflect.html" class="" aria-label="Proxy和Reflect"><!--[--><!--]--> Proxy和Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/Promise.html" class="" aria-label="Promise"><!--[--><!--]--> Promise <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/Iterator%E5%92%8CGenerator.html" class="" aria-label="Iterator和Generator"><!--[--><!--]--> Iterator和Generator <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/async,await,%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF.html" class="" aria-label="async，await，事件循环"><!--[--><!--]--> async，await，事件循环 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86.html" class="" aria-label="错误处理"><!--[--><!--]--> 错误处理 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html" class="router-link-active router-link-exact-active router-link-active" aria-label="模块化"><!--[--><!--]--> 模块化 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/JSON%E7%BB%86%E6%9E%90,%E6%B5%8F%E8%A7%88%E5%99%A8%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.html" class="" aria-label="JSON细析, 浏览器数据存储"><!--[--><!--]--> JSON细析, 浏览器数据存储 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/BOM,DOM%E7%AE%80%E6%9E%90.html" class="" aria-label="BOM,DOM简析"><!--[--><!--]--> BOM,DOM简析 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>设计模式</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html" class="" aria-label="工厂模式"><!--[--><!--]--> 工厂模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F.html" class="" aria-label="工厂方法模式"><!--[--><!--]--> 工厂方法模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html" class="" aria-label="抽象工厂模式"><!--[--><!--]--> 抽象工厂模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html" class="" aria-label="单例模式"><!--[--><!--]--> 单例模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F.html" class="" aria-label="适配器模式"><!--[--><!--]--> 适配器模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F(%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E8%80%85%E6%A8%A1%E5%BC%8F%E6%88%96%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6)/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.html" class="" aria-label="观察者模式"><!--[--><!--]--> 观察者模式 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>软件设计</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/SOLID.html" class="" aria-label="SOLD"><!--[--><!--]--> SOLD <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>算法</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/%E7%AE%97%E6%B3%95/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE.html" class="" aria-label="二分查找"><!--[--><!--]--> 二分查找 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小册"><span class="title">小册</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小册"><span class="title">小册</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/book/typescript%E9%80%9A%E8%A7%88.html" class="" aria-label="typescript通览"><!--[--><!--]--> typescript通览 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/blog/codes.md" class="" aria-label="碎片"><!--[--><!--]--> 碎片 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/chrome.html" class="" aria-label="谷歌插件"><!--[--><!--]--> 谷歌插件 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/npm.html" class="" aria-label="NPM PACKAGES"><!--[--><!--]--> NPM PACKAGES <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/bar/contact-author" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading">模块化 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#什么是模块化" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是模块化？"><!--[--><!--]--> 什么是模块化？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#模块化的历史" class="router-link-active router-link-exact-active sidebar-item" aria-label="模块化的历史"><!--[--><!--]--> 模块化的历史 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#没有模块化带来的问题" class="router-link-active router-link-exact-active sidebar-item" aria-label="没有模块化带来的问题"><!--[--><!--]--> 没有模块化带来的问题 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#commonjs规范和node" class="router-link-active router-link-exact-active sidebar-item" aria-label="CommonJS规范和Node"><!--[--><!--]--> CommonJS规范和Node <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#node-js模块化" class="router-link-active router-link-exact-active sidebar-item" aria-label="Node.js模块化"><!--[--><!--]--> Node.js模块化 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#下面来详细介绍一个module-exports。" class="router-link-active router-link-exact-active sidebar-item" aria-label="下面来详细介绍一个module.exports。"><!--[--><!--]--> 下面来详细介绍一个module.exports。 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#下面来详细介绍一个require的导入细节" class="router-link-active router-link-exact-active sidebar-item" aria-label="下面来详细介绍一个require的导入细节"><!--[--><!--]--> 下面来详细介绍一个require的导入细节 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#模块的加载细节" class="router-link-active router-link-exact-active sidebar-item" aria-label="模块的加载细节"><!--[--><!--]--> 模块的加载细节 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#commonjs规范缺点" class="router-link-active router-link-exact-active sidebar-item" aria-label="CommonJS规范缺点"><!--[--><!--]--> CommonJS规范缺点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#amd规范" class="router-link-active router-link-exact-active sidebar-item" aria-label="AMD规范"><!--[--><!--]--> AMD规范 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#cmd规范" class="router-link-active router-link-exact-active sidebar-item" aria-label="CMD规范"><!--[--><!--]--> CMD规范 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#es-module" class="router-link-active router-link-exact-active sidebar-item" aria-label="ES Module"><!--[--><!--]--> ES Module <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#基本使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本使用"><!--[--><!--]--> 基本使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#exports关键字" class="router-link-active router-link-exact-active sidebar-item" aria-label="exports关键字"><!--[--><!--]--> exports关键字 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#import关键字" class="router-link-active router-link-exact-active sidebar-item" aria-label="import关键字"><!--[--><!--]--> import关键字 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#export和import结合使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="export和import结合使用"><!--[--><!--]--> export和import结合使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#default用法" class="router-link-active router-link-exact-active sidebar-item" aria-label="default用法"><!--[--><!--]--> default用法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#import函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="import函数"><!--[--><!--]--> import函数 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/JavaScript%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/%E6%A8%A1%E5%9D%97%E5%8C%96.html#es-module的解析流程" class="router-link-active router-link-exact-active sidebar-item" aria-label="ES Module的解析流程"><!--[--><!--]--> ES Module的解析流程 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="模块化" tabindex="-1"><a class="header-anchor" href="#模块化" aria-hidden="true">#</a> 模块化</h1><p>众所周知，js在前端开发中的地位。学好它，真的很重要。</p><p>下面这篇文章，介绍一下模块化。</p><h2 id="什么是模块化" tabindex="-1"><a class="header-anchor" href="#什么是模块化" aria-hidden="true">#</a> 什么是模块化？</h2><p>到底什么是模块化、模块化开发呢？</p><ul><li>事实上模块化开发最终的目的是将程序划分成一个个小的结构。</li><li>这个结构中编写属于自己的逻辑代码，有自己的作用域，不会影响到其他的结构。</li><li>这个结构可以将自己希望暴露的变量、函数、对象等导出给其结构使用。</li><li>也可以通过某种方式，导入另外结构中的变量、函数、对象等。</li></ul><p>上面说提到的结构，就是模块；按照这种结构划分开发程序的过程，就是模块化开发的过程。</p><h2 id="模块化的历史" tabindex="-1"><a class="header-anchor" href="#模块化的历史" aria-hidden="true">#</a> 模块化的历史</h2><p>在网页开发的早期，Brendan Eich开发JavaScript仅仅作为一种脚本语言，做一些简单的表单验证或动画实现等，那个时候代码还是很少的：</p><ul><li>这个时候我们只需要讲JavaScript代码写到</li><li>并没有必要放到多个文件中来编写。</li></ul><p>但是随着前端和JavaScript的快速发展，JavaScript代码变得越来越复杂了：</p><ul><li>ajax的出现，前后端开发分离，意味着后端返回数据后，我们需要通过JavaScript进行前端页面的渲染。</li><li>SPA的出现，前端页面变得更加复杂：包括前端路由、状态管理等等一系列复杂的需求需要通过JavaScript来实现。</li><li>包括Node的实现，JavaScript编写复杂的后端程序，没有模块化是致命的硬伤。</li></ul><p>所以，模块化已经是JavaScript一个非常迫切的需求。所以ES6（2015）才推出了自己的模块化方案。</p><p>在此之前，为了让JavaScript支持模块化，涌现出了很多不同的模块化规范：AMD、CMD、CommonJS等。</p><h2 id="没有模块化带来的问题" tabindex="-1"><a class="header-anchor" href="#没有模块化带来的问题" aria-hidden="true">#</a> 没有模块化带来的问题</h2><ul><li>比如命名冲突的问题。</li></ul><p>通过立即函数调用表达式（IIFE）来解决上面的问题。因为函数有自己的作用域，不会造成不同文件命名冲突。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">// a.js</span>
    <span class="token keyword">var</span> moduleA <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;llm&quot;</span>
      <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">22</span>
      <span class="token keyword">var</span> isFlag <span class="token operator">=</span> <span class="token boolean">true</span>

      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> name<span class="token punctuation">,</span>
        <span class="token literal-property property">isFlag</span><span class="token operator">:</span> isFlag
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
复制代码
    <span class="token comment">// b.js</span>
    <span class="token keyword">var</span> moduleB <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;zh&quot;</span>
      <span class="token keyword">var</span> isFlag <span class="token operator">=</span> <span class="token boolean">false</span>

      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> name<span class="token punctuation">,</span>
        <span class="token literal-property property">isFlag</span><span class="token operator">:</span> isFlag
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
复制代码
    <span class="token comment">// 使用</span>
    moduleA<span class="token punctuation">.</span>name
    moduleB<span class="token punctuation">.</span>name
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>但是，我们其实带来了新的问题：</p><ul><li>我必须记得每一个模块中返回对象的命名，才能在其他模块使用过程中正确的使用。</li><li>代码写起来混乱不堪，每个文件中的代码都需要包裹在一个匿名函数中来编写。</li><li>在没有合适的规范情况下，每个人、每个公司都可能会任意命名、甚至出现模块名称相同的情况。</li></ul><p>所以，我们会发现，虽然实现了模块化，但是我们的实现过于简单，并且是没有规范的。</p><p>我们需要制定一定的规范来约束每个人都按照这个规范去编写模块化的代码。这个规范中应该包括核心功能：模块本身可以导出暴露的属性，模块又可以导入自己需要的属性。JavaScript社区为了解决上面的问题，涌现出一系列好用的规范，接下来我们就学习具有代表性的一些规范。</p><h2 id="commonjs规范和node" tabindex="-1"><a class="header-anchor" href="#commonjs规范和node" aria-hidden="true">#</a> CommonJS规范和Node</h2><p>我们需要知道CommonJS是一个规范，最初提出来是在浏览器以外的地方使用，并且当时被命名为ServerJS，后来为了体现它的广泛性，修改为CommonJS，平时我们也会简称为CJS。</p><ul><li>Node是CommonJS在服务器端一个具有代表性的实现。</li><li>Browserify是CommonJS在浏览器中的一种实现。</li><li>webpack打包工具具备对CommonJS的支持和转换。</li></ul><p>所以，Node中对CommonJS进行了支持和实现，让我们在开发node的过程中可以方便的进行模块化开发。</p><ul><li>在Node中每一个js文件都是一个单独的模块。</li><li>这个模块中包括CommonJS规范的核心变量：exports、module.exports、require。</li><li>我们可以使用这些变量来方便的进行模块化开发。</li></ul><p>前面我们提到过模块化的核心是导出和导入，Node中对其进行了实现：</p><ul><li>exports和module.exports可以负责对模块中的内容进行导出。</li><li>require函数可以帮助我们导入其他模块（自定义模块、系统模块、第三方库模块）中的内容。</li></ul><h2 id="node-js模块化" tabindex="-1"><a class="header-anchor" href="#node-js模块化" aria-hidden="true">#</a> Node.js模块化</h2><p>Node中对CommonJS进行了支持和实现，让我们在开发node的过程中可以方便的进行模块化开发：</p><ul><li>在Node中每一个js文件都是一个单独的模块。</li><li>这个模块中包括CommonJS规范的核心变量：<code>exports、module.exports、require</code>。</li><li><code>exports</code>和<code>module.exports</code>可以负责对模块中的内容进行导出。</li><li><code>require</code>函数可以帮助我们导入其他模块（自定义模块、系统模块、第三方库模块）中的内容。</li></ul><p>下面我们将来介绍<code>exports、module.exports、require</code>的使用。</p><ul><li>exports是一个对象，我们可以在这个对象中添加很多个属性，添加的属性会导出。</li><li>我们也可以通过module.exports直接导出一个对象。</li><li>我们通过<code>require()</code>函数导入一个文件。并且该文件导出的变量。</li></ul><h3 id="下面来详细介绍一个module-exports。" tabindex="-1"><a class="header-anchor" href="#下面来详细介绍一个module-exports。" aria-hidden="true">#</a> 下面来详细介绍一个<code>module.exports</code>。</h3><ul><li>CommonJS中是没有module.exports的概念的。</li><li>但是为了实现模块的导出，Node中使用的是Module的类，每一个模块都是Module的一个实例，也就是module。</li><li><strong>所以在Node中真正用于导出的其实根本不是exports，而是module.exports。</strong></li><li>因为module才是导出的真正实现者。</li><li><strong>并且内部将<code>exports</code>赋值给<code>module.exports</code>。</strong></li></ul><p>该方式的导入导出有以下特点：</p><ul><li>Node中的文件都运行在一个函数中。可以通过打印<code>console.log(arguments.callee + &quot;&quot;)</code>来验证。</li></ul><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b76df3c440fe4282a1146bb1b4335d62~tplv-k3u1fbpfcp-watermark.awebp?" alt="image.png"></p><ul><li>导入导出是值的引用，如果导出的是一个基本数据类型值，那么导出文件改变该值，然后导入文件该变量的值也不会变。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">// a.js</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./b.js&quot;</span><span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;llm&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
复制代码
    <span class="token comment">// b.js</span>
    <span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;zh&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
      <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;foo函数~&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// llm</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>

    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> info
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li>他是通过require <strong>函数</strong>来导入的，只有在<strong>执行js代码</strong>才会知道模块的依赖关系。</li><li>代码是同步执行的。</li><li>模块多次引入，只会加载一次。每个module内部会存在一个loaded来确定是否被加载过。</li><li>代码循环引入的时候，深度优先来加载模块。然后再广度优先。</li></ul><h3 id="下面来详细介绍一个require的导入细节" tabindex="-1"><a class="header-anchor" href="#下面来详细介绍一个require的导入细节" aria-hidden="true">#</a> 下面来详细介绍一个<code>require</code>的导入细节</h3><p>我们现在已经知道，require是一个函数，可以帮助我们引入一个文件（模块）中导出的对象。</p><p>那么，require的查找规则是怎么样的呢？</p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fdist%2Flatest-v14.x%2Fdocs%2Fapi%2Fmodules.html%23modules_all_together" target="_blank" rel="noopener noreferrer">详细查找规则，请访问这里<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>这里我总结比较常见的查找规则：导入格式如下：require(X)</p><ul><li><p>X是一个Node核心模块，比如path、http。</p><ul><li>直接返回核心模块，并且停止查找。</li></ul></li><li><p>X是以</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>./
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>或</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>../
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>或</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>（根目录）开头的。</p><ul><li>第一步：将X当做一个文件在对应的目录下查找。 <ul><li>如果有后缀名，按照后缀名的格式查找对应的文件。</li><li>如果没有后缀名，会按照如下顺序： <ul><li>直接查找文件X</li><li>查找X.js文件</li><li>查找X.json文件</li><li>查找X.node文件</li></ul></li></ul></li><li>第二步：没有找到对应的文件，将X作为一个目录 <ul><li>查找目录下面的index文件 <ul><li>查找X/index.js文件</li><li>查找X/index.json文件</li><li>查找X/index.node文件</li></ul></li></ul></li><li>如果没有找到，那么报错：not found</li></ul></li><li><p>直接是一个X（没有路径），并且X不是一个核心模块。那么它将向上级目录查找node_modules文件。直到查找到根目录下。我们可以通过module.paths打印出这些查找目录。如果上面的路径中都没有找到，那么报错：not found。</p></li></ul><h2 id="模块的加载细节" tabindex="-1"><a class="header-anchor" href="#模块的加载细节" aria-hidden="true">#</a> 模块的加载细节</h2><ul><li>模块在被第一次引入时，模块中的js代码会被运行一次</li><li>模块被多次引入时，会缓存，最终只加载（运行）一次</li></ul><p>为什么只会加载运行一次呢？</p><p>这是因为每个模块对象module都有一个属性：loaded。为false表示还没有加载，为true表示已经加载。</p><ul><li>如果有循环引入，那么加载顺序是什么？</li></ul><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e66f08957c0045e8a32a285006628ab0~tplv-k3u1fbpfcp-watermark.awebp?" alt="image.png"> 如上图，Node采用的是<strong>深度优先算法</strong>：main -&gt; aaa -&gt; ccc -&gt; ddd -&gt; eee -&gt;bbb</p><h2 id="commonjs规范缺点" tabindex="-1"><a class="header-anchor" href="#commonjs规范缺点" aria-hidden="true">#</a> CommonJS规范缺点</h2><ul><li>CommonJS加载模块是同步的： <ul><li>同步的意味着只有等到对应的模块加载完毕，当前模块中的内容才能被运行。</li><li>这个在服务器不会有什么问题，因为服务器加载的js文件都是本地文件，加载速度非常快。</li></ul></li></ul><p>如果将它应用于浏览器呢？</p><ul><li>浏览器加载js文件需要先从服务器将文件下载下来，之后再加载运行。</li><li>那么采用同步的就意味着后续的js代码都无法正常运行，即使是一些简单的DOM操作。所以在浏览器中，我们通常不使用CommonJS规范。当然在webpack中使用CommonJS是另外一回事。因为它会将我们的代码转成浏览器可以直接执行的代码。</li></ul><h2 id="amd规范" tabindex="-1"><a class="header-anchor" href="#amd规范" aria-hidden="true">#</a> AMD规范</h2><p>在早期为了可以在浏览器中使用模块化，通常会采用AMD或CMD。但是目前一方面现代的浏览器已经支持ES Modules，另一方面借助于webpack等工具可以实现对CommonJS或者ES Module代码的转换。AMD和CMD已经使用非常少了，所以这里我们进行简单的演练。</p><p>AMD主要是应用于浏览器的一种模块化规范：</p><ul><li>AMD是Asynchronous Module Definition（异步模块定义）的缩写。它采用的是异步加载模块。</li><li>我们提到过，规范只是定义代码的应该如何去编写，只有有了具体的实现才能被应用。</li><li>AMD实现的比较常用的库是require.js和curl.js。</li></ul><p>require.js的使用</p><ul><li>下载源码：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frequirejs%2Frequirejs%E3%80%82" target="_blank" rel="noopener noreferrer">github.com/requirejs/r…<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 找到其中的require.js文件。</li><li>定义HTML的script标签引入require.js和定义入口文件。data-main属性的作用是在加载完src的文件后会加载执行该文件</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>// index.html
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./require.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-main</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./index.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
复制代码
    //main.js
    require.config({
      baseUrl: &#39;&#39;, // 默认是main.js的文件夹路径
      paths: {
        foo: &quot;./foo&quot;
      }
    })

    require([&quot;foo&quot;], function(foo) {
      console.log(&quot;main:&quot;, foo)
    })
复制代码
    // foo.js
    define(function() {
      const name = &quot;zh&quot;
      const age = 22
      function sum(num1, num2) {
        return num1 + num2
      }

      return {
        name,
        age,
        sum
      }
    })
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="cmd规范" tabindex="-1"><a class="header-anchor" href="#cmd规范" aria-hidden="true">#</a> CMD规范</h2><p>CMD规范也是应用于浏览器的一种模块化规范：</p><ul><li>CMD 是Common Module Definition（通用模块定义）的缩写。它也采用了异步加载模块，但是它将CommonJS的优点吸收了过来。</li><li>AMD实现的比较常用的库是SeaJS。</li></ul><p>SeaJS的使用</p><ul><li>下载源码：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fseajs%2Fseajs%E3%80%82" target="_blank" rel="noopener noreferrer">github.com/seajs/seajs…<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 找到dist文件夹下的sea.js。</li><li>引入sea.js和使用主入口文件。</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>    // index.html
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./sea.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        seajs<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;./main.js&quot;</span><span class="token punctuation">)</span>
      </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
复制代码
    //main.js
    define(function(require, exports, module) {
      const foo = require(&quot;./foo&quot;)
      console.log(&quot;main:&quot;, foo)
    })
复制代码
    // foo.js
   define(function(require, exports, module) {
      const name = &quot;zh&quot;
      const age = 22
      function sum(num1, num2) {
        return num1 + num2
      }

      // exports.name = name
      // exports.age = age

      module.exports = {
        name,
        age,
        sum
      }
    });
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="es-module" tabindex="-1"><a class="header-anchor" href="#es-module" aria-hidden="true">#</a> ES Module</h2><p>ES Module和CommonJS的模块化有一些不同之处：</p><ul><li>一方面它使用了import和export关键字来实现模块化。</li><li>另一方面它采用编译期的静态分析，并且也加入了动态引用的方式。</li><li>export负责将模块内的内容导出。</li><li>import负责从其他模块导入内容。</li><li>采用ES Module将自动采用严格模式：use strict。</li></ul><h3 id="基本使用" tabindex="-1"><a class="header-anchor" href="#基本使用" aria-hidden="true">#</a> 基本使用</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>    // index.html
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./main.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
复制代码
    // foo.js
    let obj = {
      name: &quot;zh&quot;,
      age: 22
    }
    
    export default sum
复制代码
    // main.js
    import foo from &#39;./foo.js&#39;
    console.log(foo) 
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>在html文件加载入口文件的时候，需要指定type为module。</li><li>在打开html文件时，需要开启本地服务，而不能直接打开运行在浏览器上。</li></ul><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f3e76caf40146af9bc716964d6c6a28~tplv-k3u1fbpfcp-watermark.awebp?" alt="image.png"> <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FGuide%2FModules" target="_blank" rel="noopener noreferrer">这个在MDN上面有给出解释：<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><ul><li>你需要注意本地测试 — 如果你通过本地加载Html 文件 (比如一个 file:// 路径的文件), 你将会遇到 CORS 错误，因为Javascript 模块安全性需要。</li><li>你需要通过一个服务器来测试。</li></ul><h3 id="exports关键字" tabindex="-1"><a class="header-anchor" href="#exports关键字" aria-hidden="true">#</a> exports关键字</h3><p>export关键字将一个模块中的变量、函数、类等导出。</p><p>我们希望将其他中内容全部导出，它可以有如下的方式：</p><ul><li>方式一：在语句声明的前面直接加上export关键字。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">export</span> <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zh&quot;</span>
    <span class="token keyword">export</span> <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">22</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>方式二：将所有需要导出的标识符，放到export后面的 <code>{}</code> 中。<strong>注意：这里的 {}里面不是ES6的对象字面量的增强写法，{}也不是表示一个对象的。所以： export {name: name}，是错误的写法。</strong></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zh&quot;</span>
    <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">22</span>
    <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;foo function&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">export</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">,</span>
      age<span class="token punctuation">,</span>
      foo
    <span class="token punctuation">}</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>方式三：导出时给标识符起一个别名。(基本没用，一般在导入文件中起别名)。然后在导入文件中就只能使用别名来获取。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">export</span> <span class="token punctuation">{</span>
      name <span class="token keyword">as</span> fName<span class="token punctuation">,</span>
      age <span class="token keyword">as</span> fAge<span class="token punctuation">,</span>
      foo <span class="token keyword">as</span> fFoo
    <span class="token punctuation">}</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="import关键字" tabindex="-1"><a class="header-anchor" href="#import关键字" aria-hidden="true">#</a> import关键字</h3><p>import关键字负责从另外一个模块中导入内容。</p><p>导入内容的方式也有多种：</p><ul><li>方式一：import {标识符列表} from &#39;模块&#39;。<strong>注意：这里的{}也不是一个对象，里面只是存放导入的标识符列表内容。</strong></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">import</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./foo.js&quot;</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>方式二：导入时给标识符起别名。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">import</span> <span class="token punctuation">{</span> name <span class="token keyword">as</span> fName<span class="token punctuation">,</span> age <span class="token keyword">as</span> fAge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./foo.js&#39;</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>方式三：通过 <code>*</code> 将模块功能放到一个模块功能对象（a module object）上。然后通过起别名来使用。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> foo <span class="token keyword">from</span> <span class="token string">&#39;./foo.js&#39;</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="export和import结合使用" tabindex="-1"><a class="header-anchor" href="#export和import结合使用" aria-hidden="true">#</a> export和import结合使用</h3><p>表示导入导出。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">import</span> <span class="token punctuation">{</span> add<span class="token punctuation">,</span> sub <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./math.js&#39;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>otherProperty<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./other.js&#39;</span>

    <span class="token keyword">export</span> <span class="token punctuation">{</span>
      add<span class="token punctuation">,</span>
      sub<span class="token punctuation">,</span>
      otherProperty
    <span class="token punctuation">}</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>等价于</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">// 导入的所有文件会统一被导出</span>
    <span class="token keyword">export</span> <span class="token punctuation">{</span> add<span class="token punctuation">,</span> sub <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./math.js&#39;</span>
    <span class="token keyword">export</span> <span class="token punctuation">{</span>otherProperty<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./other.js&#39;</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>等价于</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&#39;./math.js&#39;</span>
    <span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&#39;./other.js&#39;</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>为什么要这样做呢？</p><p><strong>在开发和封装一个功能库时，通常我们希望将暴露的所有接口放到一个文件中。</strong> 这样方便指定统一的接口规范，也方便阅读。这个时候，我们就可以使用export和import结合使用。</p><h3 id="default用法" tabindex="-1"><a class="header-anchor" href="#default用法" aria-hidden="true">#</a> default用法</h3><p>前面我们学习的导出功能都是有名字的导出（named exports）：</p><ul><li>在导出export时指定了名字。</li><li>在导入import时需要知道具体的名字。</li></ul><p>还有一种导出叫做默认导出（default export）</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">// foo.js</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zh&quot;</span>
    cconst age <span class="token operator">=</span> <span class="token number">22</span>
    <span class="token keyword">export</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">,</span>
      <span class="token comment">// 或者这样的默认导出</span>
      <span class="token comment">// age as default</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">export</span> <span class="token keyword">default</span> age
复制代码
    <span class="token comment">// 导入语句: 导入的默认的导出</span>
    <span class="token keyword">import</span> foo<span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./foo.js&#39;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token comment">// 22 zh</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>默认导出export时可以不需要指定名字。</li><li>在导入时不需要使用 {}，并且可以自己来指定名字。</li><li>它也方便我们和现有的CommonJS等规范相互操作。</li></ul><p><strong>注意：在一个模块中，只能有一个默认导出（default export）。</strong></p><h3 id="import函数" tabindex="-1"><a class="header-anchor" href="#import函数" aria-hidden="true">#</a> import函数</h3><p>通过import加载一个模块，是不可以在其放到逻辑代码中的，比如：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&#39;./foo.js&#39;</span>
    <span class="token punctuation">}</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>为什么会出现这个情况呢？</p><ul><li>这是因为ES Module在被JS引擎解析时，就必须知道它的依赖关系。</li><li>由于这个时候js代码没有任何的运行，所以无法在进行类似于if判断中根据代码的执行情况。</li></ul><p>但是某些情况下，我们确确实实希望动态的来加载某一个模块：</p><ul><li>如果根据不同的条件，动态来选择加载模块的路径。</li></ul><p>这个时候我们需要使用 import() 函数来动态加载。import函数返回的结果是一个Promise。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./foo.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;res:&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>es11新增了一个属性。meta属性本身也是一个对象: { url: &quot;当前模块所在的路径&quot; }</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">)</span>
复制代码
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="es-module的解析流程" tabindex="-1"><a class="header-anchor" href="#es-module的解析流程" aria-hidden="true">#</a> ES Module的解析流程</h2><p>ES Module是如何被浏览器解析并且让模块之间可以相互引用的呢？</p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhacks.mozilla.org%2F2018%2F03%2Fes-modules-a-cartoon-deep-dive%2F" target="_blank" rel="noopener noreferrer">详细请参考这篇文章<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>ES Module的解析过程可以划分为三个阶段：</p><ul><li>阶段一：构建（Construction），根据地址查找js文件，并且下载，将其解析成模块记录（Module Record）。</li><li>阶段二：实例化（Instantiation），对模块记录进行实例化，并且分配内存空间，解析模块的导入和导出语句，把模块指向对应的内存地址。</li><li>阶段三：运行（Evaluation），运行代码，计算值，并且将值填充到内存地址中。</li></ul><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8a374437ed1417aa4f178cd99259340~tplv-k3u1fbpfcp-watermark.awebp?" alt="image.png"> 阶段一： <img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2da8ce6eb534e4c9274a77213f32a7b~tplv-k3u1fbpfcp-watermark.awebp?" alt="image.png"> 阶段二和三： <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/909358a737304c7f925ee778b46aea9a~tplv-k3u1fbpfcp-watermark.awebp?" alt="image.png"> <strong>所以，从上面可以看出在导出文件中，修改变量的值会影响到导入文件中的值。而且导入文件被限制修改导出文件的值。</strong></p><p>作者：Spirited_Away 链接：https://juejin.cn/post/7055967081166012446 来源：稀土掘金 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 13776119594@163.com">tommy.hu</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.f0c6e876.js" defer></script>
  </body>
</html>
